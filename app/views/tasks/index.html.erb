<p style="color: green"><%= notice %></p>

<% content_for :title, "Tasks" %>

<h1 style="text-align:center; color:#333;">My To-Do List</h1>
<div style="text-align:center; margin-bottom: 20px;">
  <%= link_to 'Add New Task', new_task_path, class: 'btn btn-primary' %>
  <%= link_to 'All', tasks_path, class: 'btn btn-secondary' %>
  <%= link_to 'Completed', tasks_path(filter: 'completed'), class: 'btn btn-success' %>
  <%= link_to 'Pending', tasks_path(filter: 'pending'), class: 'btn btn-warning' %>
</div>

<div style="margin: 0 auto; width: 80%; display: flex; justify-content: center;">
  <%= form_with url: tasks_path, method: :get, local: true, html: { style: 'display: flex; align-items: center; gap: 15px;' } do |form| %>
    <%= form.label :date, 'Filter by Date:', class: 'form-label', style: 'margin: 0; white-space: nowrap;' %>
    <%= form.date_field :date, class: 'form-control' %>
    <%= form.submit 'Apply Filter', class: 'btn btn-info' %>
  <% end %>
</div>

<div style="margin: 20px auto; width: 80%;">
  <% if @tasks.any? %>
    <% @tasks.each do |task| %>
      <div style="border: 1px solid #ccc; border-radius: 10px; padding: 15px; margin-bottom: 15px; background-color: #f9f9f9;">
        <h3 style="margin: 0;"> <%= task.title %> </h3>
        <p><%= task.description %></p>
        <p>Status: <strong><%= task.status.capitalize %></strong></p>
        <p>Due: <%= task.due_date.present? ? task.due_date.strftime('%B %d, %Y') : 'No due date' %></p>
        <%= link_to 'Edit', edit_task_path(task), class: 'btn btn-outline-primary btn-sm' %>
        <%= button_to 'Delete', task_path(task), method: :delete, data: { turbo_confirm: 'Are you sure you want to delete this task?' }, class: 'btn btn-outline-danger btn-sm', form: { style: 'display:inline;' } %>
      </div>
    <% end %>
  <% else %>
    <div class="alert alert-info text-center">
      <% if params[:filter] == 'completed' %>
        You have no completed tasks.
      <% elsif params[:filter] == 'pending' %>
        You have no pending tasks.
      <% elsif params[:date].present? %>
        You have no tasks on <%= Date.parse(params[:date]).strftime('%B %d, %Y') rescue params[:date] %>.
      <% else %>
        You have no tasks.
      <% end %>
    </div>
  <% end %>
</div>
